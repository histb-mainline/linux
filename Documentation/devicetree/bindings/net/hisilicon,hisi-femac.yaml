# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
%YAML 1.2
---
$id: http://devicetree.org/schemas/net/hisilicon,hisi-femac.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Hisilicon Fast Ethernet MAC controller

maintainers:
  - Yang Xiwen <forbidden405@foxmail.com>

allOf:
  - $ref: ethernet-controller.yaml

properties:
  compatible:
    items:
      - enum:
          - hisilicon,hi3516cv300-femac
          - hisilicon,hi3798mv200-femac
      - const: hisilicon,hisi-femac

  reg:
    items:
      - description: The first region is the MAC core register base and size.
      - description: The second region is the global MAC control register.

  ranges:
    maxItems: 1

  '#address-cells':
    const: 1

  '#size-cells':
    const: 1

  interrupts:
    maxItems: 1

  clocks:
    items:
      - description: MAC main clock
      - description: MAC bus interface clock
      - description: PHY clock

  clock-names:
    items:
      - const: mac
      - const: macif
      - const: phy

  resets:
    items:
      - description: MAC reset signal
      - description: PHY reset signal

  reset-names:
    items:
      - const: mac
      - const: phy

  hisilicon,phy-reset-delays-us:
    description: PHY reset timing requirement (in micro seconds).
      The integrated PHY usually have a special reset timing sequence and must
      interact with MAC controller to accomplish the entire reset procedure. So
      these properties belong to MAC controller, not PHY.
    items:
      - description: pre-reset delay for PHY
      - description: reset pulse for PHY
      - description: post-reset delay for PHY

patternProperties:
  'mdio@[0-9a-f]+':
    $ref: hisilicon,hisi-femac-mdio.yaml#

required:
  - compatible
  - reg
  - ranges
  - '#address-cells'
  - '#size-cells'
  - interrupts
  - clocks
  - resets
  - reset-names
  - phy-mode
  - phy-handle
  - hisilicon,phy-reset-delays-us

unevaluatedProperties: false

examples:
  - |
    ethernet@10090000 {
        compatible = "hisilicon,hi3516cv300-femac", "hisilicon,hisi-femac";
        reg = <0x10090000 0x1000>, <0x10091300 0x200>;
        ranges = <0x0 0x10090000 0x10000>;
        #address-cells = <1>;
        #size-cells = <1>;
        interrupts = <12>;
        clocks = <&clk_femac>, <&clk_femacif>, <&clk_fephy>;
        clock-names = "mac", "macif", "phy";
        resets = <&crg 0xec 0>, <&crg 0xec 3>;
        reset-names = "mac", "phy";
        mac-address = [00 00 00 00 00 00];
        phy-mode = "mii";
        phy-handle = <&fephy>;
        hisilicon,phy-reset-delays-us = <10000 20000 20000>;

        mdio@1100 {
            compatible = "hisilicon,hisi-femac-mdio";
            reg = <0x1100 0x20>;
            #address-cells = <1>;
            #size-cells = <0>;

            phy@1 {
                reg = <1>;
            };
        };
    };
